<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fish Adventure: Poison at 2000 - By Chayanan</title>
    <style>
        body { margin: 0; padding: 0; display: flex; justify-content: center; align-items: center; height: 100vh; background-color: #e0f7fa; font-family: 'Tahoma', sans-serif; overflow: hidden; touch-action: none; }
        #game-container { position: relative; width: 100vw; height: 100vh; max-width: 800px; max-height: 600px; overflow: hidden; box-shadow: 0 0 50px rgba(0,0,0,0.3); border: 4px solid #fff; }
        canvas { background: linear-gradient(#4fc3f7, #01579b); display: block; width: 100%; height: 100%; }
        .overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; background: rgba(0, 0, 0, 0.85); color: white; z-index: 10; text-align: center; }
        .hidden { display: none !important; }
        .menu-btn { padding: 12px 30px; margin: 8px; font-size: 20px; cursor: pointer; border: none; border-radius: 50px; background: #ffeb3b; color: #01579b; font-weight: bold; box-shadow: 0 5px #fbc02d; transition: 0.1s; }
        .menu-btn:active { transform: translateY(3px); box-shadow: 0 2px #fbc02d; }
        
        .hp-bar-container { position: absolute; top: 20px; right: 20px; width: 150px; height: 25px; background: #333; border-radius: 15px; border: 2px solid white; overflow: hidden; }
        #hp-fill { width: 100%; height: 100%; background: #4caf50; transition: 0.1s; }
        
        #status-alert { position: absolute; top: 20px; left: 50%; transform: translateX(-50%); color: #ffeb3b; font-weight: bold; font-size: 22px; text-shadow: 2px 2px #000; z-index: 5; text-align: center; width: 100%; pointer-events: none; }
        #score-display { position: absolute; top: 20px; left: 20px; color: white; font-weight: bold; font-size: 24px; text-shadow: 2px 2px #0277bd; }
        #boss-ui { position: absolute; bottom: 50px; left: 50%; transform: translateX(-50%); width: 80%; height: 15px; background: #333; border: 2px solid white; border-radius: 10px; display: none; }
        #boss-hp-fill { width: 100%; height: 100%; background: #ff1744; }
    </style>
</head>
<body>

<div id="game-container">
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <div id="score-display">‡πÅ‡∏ï‡πâ‡∏°: 0</div>
    <div id="status-alert">‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£!</div>
    <div class="hp-bar-container"><div id="hp-fill"></div></div>
    
    <div id="boss-ui"><div id="boss-hp-fill"></div><p style="margin: -25px 0 0 0; font-size: 10px; font-weight: bold; color:white; text-align: center;">BOSS: MEGA CRAB (3000 HP)</p></div>

    <div id="main-menu" class="overlay">
        <h1>FISH ADVENTURE</h1>
        <p style="color: #ea80fc;">‚ö†Ô∏è 2,000 ‡πÅ‡∏ï‡πâ‡∏°: ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÅ‡∏°‡∏á‡∏Å‡∏∞‡∏û‡∏∏‡∏ô‡∏û‡∏¥‡∏©!</p>
        <p>5,000 ‡πÅ‡∏ï‡πâ‡∏°: ‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏≠‡∏™‡∏õ‡∏π‡∏¢‡∏±‡∏Å‡∏©‡πå‡∏£‡∏∞‡∏¢‡∏∞‡∏Å‡∏£‡∏á‡πÄ‡∏•‡πá‡∏ö 180px</p>
        <button class="menu-btn" onclick="startGame()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
        <button class="menu-btn" onclick="showCredits()">‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥</button>
    </div>

    <div id="credits-menu" class="overlay hidden">
        <h2>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥</h2>
        <p><strong>‡∏î.‡∏ä.‡∏ä‡∏ç‡∏≤‡∏ô‡∏±‡∏ô‡∏ï‡πå ‡πÄ‡∏î‡∏ä‡∏ß‡∏á‡∏©‡∏≤</strong> ‡∏°.2/4 ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà 1</p>
        <button class="menu-btn" onclick="showMainMenu()">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
    </div>

    <div id="game-over" class="overlay hidden">
        <h2 style="font-size: 40px; color: #ff5252;">GAME OVER</h2>
        <p id="final-score" style="font-size: 24px; margin-bottom: 20px;"></p>
        <button class="menu-btn" onclick="startGame()">‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        <button class="menu-btn" onclick="showMainMenu()">‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</button>
    </div>
</div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const hpFill = document.getElementById('hp-fill');
    const bossUi = document.getElementById('boss-ui');
    const bossHpFill = document.getElementById('boss-hp-fill');
    const scoreDisplay = document.getElementById('score-display');
    const statusAlert = document.getElementById('status-alert');
    
    let gameRunning = false, score = 0, hp = 100, items = [], bubbles = [], effects = [], lastHungerUpdate = 0;
    let poisonTimer = 0;
    let audioCtx = null;
    
    const player = { x: 400, y: 300, targetX: 400, targetY: 300, facing: 1 };
    const boss = { active: false, x: 400, y: 800, hp: 3000, maxHp: 3000 };

    function initAudio() {
        if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        if (audioCtx.state === 'suspended') audioCtx.resume();
    }

    function playSound(f, t, d, v = 0.05) {
        if (!audioCtx) return;
        try {
            const o = audioCtx.createOscillator(), g = audioCtx.createGain();
            o.type = t; o.frequency.setValueAtTime(f, audioCtx.currentTime);
            g.gain.setValueAtTime(v, audioCtx.currentTime);
            g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + d);
            o.connect(g); g.connect(audioCtx.destination);
            o.start(); o.stop(audioCtx.currentTime + d);
        } catch(e) {}
    }

    const updateInput = (e) => {
        const rect = canvas.getBoundingClientRect();
        const clientX = e.touches ? e.touches[0].clientX : e.clientX;
        const clientY = e.touches ? e.touches[0].clientY : e.clientY;
        player.targetX = (clientX - rect.left) * (canvas.width / rect.width);
        player.targetY = (clientY - rect.top) * (canvas.height / rect.height);
    };
    canvas.addEventListener('mousemove', updateInput);
    canvas.addEventListener('touchmove', (e) => { e.preventDefault(); updateInput(e); }, { passive: false });
    canvas.addEventListener('mousedown', updateInput);
    canvas.addEventListener('touchstart', updateInput);

    function createExplosion(x, y) {
        effects.push({ x, y, r: 10, opacity: 1 });
        playSound(100, 'sawtooth', 0.4, 0.1);
    }

    function startGame() {
        initAudio();
        document.querySelectorAll('.overlay').forEach(el => el.classList.add('hidden'));
        gameRunning = true; score = 0; hp = 100; items = []; bubbles = []; effects = []; poisonTimer = 0;
        boss.active = false; boss.hp = 3000; boss.y = 800;
        bossUi.style.display = 'none';
        player.x = player.targetX = 400; player.y = player.targetY = 300;
        lastHungerUpdate = Date.now();
        updateHPUI();
        scoreDisplay.innerText = `‡πÅ‡∏ï‡πâ‡∏°: 0`;
        requestAnimationFrame(animate);
    }

    function showCredits() { document.getElementById('main-menu').classList.add('hidden'); document.getElementById('credits-menu').classList.remove('hidden'); }
    function showMainMenu() { document.querySelectorAll('.overlay').forEach(el => el.classList.add('hidden')); document.getElementById('main-menu').classList.remove('hidden'); gameRunning = false; }

    function updateHPUI() {
        hpFill.style.width = hp + '%';
        if (poisonTimer > 0) hpFill.style.background = "#ea80fc";
        else hpFill.style.background = hp > 60 ? '#4caf50' : (hp > 30 ? '#ffeb3b' : '#ff5252');
        if (hp <= 0 && gameRunning) gameOver();
    }

    function gameOver() {
        gameRunning = false;
        playSound(60, 'square', 0.5, 0.2);
        document.getElementById('game-over').classList.remove('hidden');
        document.getElementById('final-score').innerText = `‡πÅ‡∏ï‡πâ‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠: ${score}`;
    }

    function drawFish(x, y, color = '#ff9800', sizeScale = 1, facing = 1) {
        ctx.save(); ctx.translate(x, y); if (facing === -1) ctx.scale(-1, 1);
        ctx.fillStyle = poisonTimer > 0 ? '#ea80fc' : color;
        ctx.beginPath(); ctx.ellipse(0, 0, 30*sizeScale, 20*sizeScale, 0, 0, Math.PI * 2); ctx.fill();
        ctx.beginPath(); ctx.moveTo(-25*sizeScale, 0); ctx.lineTo(-45*sizeScale, -15*sizeScale); ctx.lineTo(-45*sizeScale, 15*sizeScale); ctx.closePath(); ctx.fill();
        ctx.fillStyle = 'white'; ctx.beginPath(); ctx.arc(15*sizeScale, -5*sizeScale, 5*sizeScale, 0, Math.PI*2); ctx.fill();
        ctx.fillStyle = 'black'; ctx.beginPath(); ctx.arc(17*sizeScale, -5*sizeScale, 2*sizeScale, 0, Math.PI*2); ctx.fill();
        ctx.restore();
    }

    function drawJellyfish(x, y) {
        ctx.save();
        let move = Math.sin(Date.now() * 0.005) * 5;
        ctx.fillStyle = 'rgba(234, 128, 252, 0.8)';
        ctx.beginPath(); ctx.arc(x, y + move, 20, Math.PI, 0); ctx.fill();
        ctx.strokeStyle = 'rgba(234, 128, 252, 0.6)'; ctx.lineWidth = 3;
        for(let i=-15; i<=15; i+=10) {
            ctx.beginPath(); ctx.moveTo(x+i, y+move);
            ctx.quadraticCurveTo(x+i+Math.sin(Date.now()*0.01+i)*5, y+move+30, x+i, y+move+40); ctx.stroke();
        }
        ctx.restore();
    }

    function drawBoss() {
        if (!boss.active) return;
        ctx.save();
        for(let i=0; i<3; i++) {
            drawLeg(boss.x - 85, boss.y + 10 + (i*15), -1, i * 1.5);
            drawLeg(boss.x + 85, boss.y + 10 + (i*15), 1, i * 1.5 + Math.PI);
        }
        drawClaw(boss.x - 100, boss.y, -1);
        drawClaw(boss.x + 100, boss.y, 1);
        ctx.fillStyle = '#b71c1c'; ctx.strokeStyle = '#880e4f'; ctx.lineWidth = 6;
        ctx.beginPath(); ctx.ellipse(boss.x, boss.y, 140, 90, 0, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
        ctx.fillStyle = 'white';
        ctx.beginPath(); ctx.arc(boss.x - 50, boss.y - 45, 25, 0, Math.PI*2); ctx.fill();
        ctx.beginPath(); ctx.arc(boss.x + 50, boss.y - 45, 25, 0, Math.PI*2); ctx.fill();
        ctx.fillStyle = 'black';
        ctx.beginPath(); ctx.arc(boss.x - 50, boss.y - 50, 10, 0, Math.PI*2); ctx.fill();
        ctx.beginPath(); ctx.arc(boss.x + 50, boss.y - 50, 10, 0, Math.PI*2); ctx.fill();
        ctx.restore();
    }

    function drawClaw(x, y, side) {
        ctx.save(); ctx.translate(x, y); ctx.scale(side, 1);
        let openAngle = Math.sin(Date.now() * 0.01) * 0.3;
        ctx.fillStyle = '#d32f2f'; ctx.strokeStyle = '#b71c1c'; ctx.lineWidth = 5;
        ctx.beginPath(); ctx.moveTo(0, 0); ctx.quadraticCurveTo(70, -70, 130, -120); ctx.stroke();
        ctx.save(); ctx.translate(130, -120); ctx.rotate(-openAngle);
        ctx.beginPath(); ctx.ellipse(40, -20, 60, 35, -0.5, 0, Math.PI * 2); ctx.fill(); ctx.stroke(); ctx.restore();
        ctx.save(); ctx.translate(130, -120); ctx.rotate(openAngle);
        ctx.beginPath(); ctx.ellipse(40, 20, 60, 35, 0.5, 0, Math.PI * 2); ctx.fill(); ctx.stroke(); ctx.restore();
        ctx.restore();
    }

    function drawLeg(x, y, side, offset) {
        ctx.save(); ctx.translate(x, y); ctx.scale(side, 1);
        let legMove = Math.sin(Date.now() * 0.01 + offset) * 20;
        ctx.strokeStyle = '#d32f2f'; ctx.lineWidth = 8;
        ctx.beginPath(); ctx.moveTo(0, 0); ctx.lineTo(40 + legMove, 40); ctx.lineTo(25 + legMove, 75); ctx.stroke();
        ctx.restore();
    }

    function animate() {
        if (!gameRunning) return;
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        let now = Date.now();
        if (now - lastHungerUpdate > 1000) { hp -= 4; updateHPUI(); lastHungerUpdate = now; }

        if (poisonTimer > 0) {
            hp -= 0.5; poisonTimer--; updateHPUI();
        }

        let dx = player.targetX - player.x;
        let dy = player.targetY - player.y;
        player.x += dx * 0.12;
        player.y += dy * 0.12;
        player.facing = dx > 0 ? 1 : -1;
        player.x = Math.max(45, Math.min(canvas.width - 45, player.x));
        player.y = Math.max(45, Math.min(canvas.height - 45, player.y));

        if (Math.random() < 0.1) bubbles.push({x: Math.random()*canvas.width, y: 610, s: Math.random()*5+2, sp: Math.random()*2+1});
        ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
        bubbles.forEach((b, i) => { ctx.beginPath(); ctx.arc(b.x, b.y, b.s, 0, Math.PI*2); ctx.fill(); b.y -= b.sp; if(b.y < -10) bubbles.splice(i, 1); });

        // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
        if (poisonTimer > 0) {
            statusAlert.innerText = "ü§¢ ‡∏ï‡∏¥‡∏î‡∏û‡∏¥‡∏©! ‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏•‡∏î‡πÄ‡∏£‡πá‡∏ß‡∏°‡∏≤‡∏Å!";
            statusAlert.style.color = "#ea80fc";
        } else if (boss.active) {
            statusAlert.innerText = "üî• MEGA BOSS: ‡∏Å‡∏£‡∏á‡πÄ‡∏•‡πá‡∏ö‡∏¢‡∏±‡∏Å‡∏©‡πå!";
            statusAlert.style.color = (Math.sin(Date.now() * 0.01) > 0) ? "#ff1744" : "#ffeb3b";
        } else if (score >= 2000) {
            statusAlert.innerText = "üëæ ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÅ‡∏°‡∏á‡∏Å‡∏∞‡∏û‡∏∏‡∏ô‡∏û‡∏¥‡∏©‡πÇ‡∏ú‡∏•‡πà‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß!";
            statusAlert.style.color = "#ea80fc";
        } else if (score >= 1000) {
            statusAlert.innerText = "üö® ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢! ‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î‡∏¢‡∏±‡∏Å‡∏©‡πå‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏á!";
            statusAlert.style.color = "#ff5252";
        } else if (score >= 500) {
            statusAlert.innerText = "‚ö†Ô∏è ‡∏£‡∏∞‡∏ß‡∏±‡∏á! ‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î‡πÄ‡∏•‡πá‡∏Å‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô!";
            statusAlert.style.color = "#ffeb3b";
        } else {
            statusAlert.innerText = "‡πÇ‡∏´‡∏°‡∏î: ‡∏ü‡∏≤‡∏£‡πå‡∏°‡∏õ‡∏•‡∏≤‡πÅ‡∏•‡∏∞‡πÑ‡∏™‡πâ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô";
            statusAlert.style.color = "#4caf50";
        }

        if (score >= 5000 && !boss.active && boss.hp > 0) { 
            boss.active = true; bossUi.style.display = 'block'; 
            playSound(150, 'sawtooth', 0.5, 0.2); 
        }
        
        if (boss.active) {
            if (boss.y > 480) boss.y -= 1.0;
            boss.x += (player.x - boss.x) * 0.08; 
            if (Math.sqrt((boss.x - player.x)**2 + (boss.y - player.y)**2) < 180) { 
                hp -= 1.2; updateHPUI();
                if(Math.random() < 0.1) playSound(120, 'square', 0.1, 0.04);
            }
            drawBoss();
        }

        drawFish(player.x, player.y, '#ff9800', 1, player.facing);

        // --- ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏≠‡πÄ‡∏ó‡∏° ---
        let spawnRate = boss.active ? 0.09 : 0.08;
        if (Math.random() < spawnRate) {
            let rand = Math.random(), type = 'food';
            
            if (boss.active) {
                if (rand < 0.3) type = 'mine'; 
                else if (rand < 0.5) type = 'big_mine';
                else if (rand < 0.65) type = 'jellyfish';
                else if (rand < 0.75) type = 'small_fish'; 
                else if (rand > 0.95) type = 'food'; 
                else type = 'trash';
            } else {
                if (score >= 2000) { // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏ï‡πâ‡∏°‡∏ñ‡∏∂‡∏á 2000 ‡πÅ‡∏°‡∏á‡∏Å‡∏∞‡∏û‡∏∏‡∏ô‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏°‡∏≤
                    if (rand < 0.15) type = 'big_mine';
                    else if (rand < 0.35) type = 'mine';
                    else if (rand < 0.55) type = 'jellyfish'; 
                    else if (rand > 0.85) type = 'small_fish';
                    else if (rand > 0.75) type = 'worm';
                    else type = 'food';
                } else if (score >= 1000) {
                    if (rand < 0.15) type = 'big_mine';
                    else if (rand < 0.45) type = 'mine';
                    else if (rand > 0.85) type = 'small_fish';
                    else if (rand > 0.75) type = 'worm';
                    else type = 'food';
                } else if (score >= 500) {
                    if (rand < 0.35) type = 'mine'; 
                    else if (rand > 0.85) type = 'small_fish';
                    else if (rand > 0.75) type = 'worm';
                    else type = 'food';
                } else {
                    // 0-499 ‡πÅ‡∏ï‡πâ‡∏°
                    if (rand < 0.25) type = 'trash';
                    else if (rand > 0.85) type = 'small_fish';
                    else if (rand > 0.7) type = 'worm';
                    else type = 'food';
                }
            }
            items.push({ x: Math.random()*740+30, y: -50, type: type });
        }

        for (let i = items.length - 1; i >= 0; i--) {
            let item = items[i];
            item.y += 4;
            if (item.type === 'food') { ctx.fillStyle = '#ffeb3b'; ctx.beginPath(); ctx.arc(item.x, item.y, 8, 0, Math.PI*2); ctx.fill(); }
            else if (item.type === 'worm') { ctx.fillStyle = '#ff80ab'; ctx.fillRect(item.x-15, item.y-5, 30, 10); }
            else if (item.type === 'trash') { ctx.fillStyle = '#757575'; ctx.fillRect(item.x-12, item.y-12, 24, 24); }
            else if (item.type === 'jellyfish') { drawJellyfish(item.x, item.y); }
            else if (item.type === 'mine') { ctx.fillStyle = '#212121'; ctx.beginPath(); ctx.arc(item.x, item.y, 15, 0, Math.PI*2); ctx.fill(); ctx.fillStyle='red'; ctx.beginPath(); ctx.arc(item.x, item.y, 4, 0, Math.PI*2); ctx.fill(); }
            else if (item.type === 'big_mine') { ctx.fillStyle = '#000'; ctx.beginPath(); ctx.arc(item.x, item.y, 35, 0, Math.PI*2); ctx.fill(); ctx.fillStyle='red'; ctx.beginPath(); ctx.arc(item.x, item.y, 10, 0, Math.PI*2); ctx.fill(); }
            else if (item.type === 'small_fish') { drawFish(item.x, item.y, '#00e5ff', 0.5, 1); }

            let d = Math.sqrt((player.x - item.x)**2 + (player.y - item.y)**2);
            if (d < 35) {
                if (item.type === 'food') { score += 10; hp = Math.min(100, hp + 10); playSound(800, 'sine', 0.05); }
                else if (item.type === 'worm') { score += 20; hp = Math.min(100, hp + 30); playSound(1000, 'sine', 0.05); }
                else if (item.type === 'small_fish') { score += 50; hp = Math.min(100, hp + 60); playSound(1500, 'sine', 0.1); }
                else if (item.type === 'trash') { hp -= 20; playSound(200, 'square', 0.1); }
                else if (item.type === 'jellyfish') { poisonTimer = 300; playSound(300, 'sawtooth', 0.3); }
                else if (item.type === 'mine') { hp -= 40; createExplosion(item.x, item.y); }
                else if (item.type === 'big_mine') { hp -= 70; createExplosion(item.x, item.y); }
                updateHPUI(); items.splice(i, 1);
                scoreDisplay.innerText = `‡πÅ‡∏ï‡πâ‡∏°: ${score}`;
                continue;
            }

            if (boss.active && (item.type === 'mine' || item.type === 'big_mine')) {
                if (Math.sqrt((boss.x - item.x)**2 + (boss.y - item.y)**2) < 160) {
                    boss.hp -= (item.type === 'big_mine' ? 80 : 40);
                    createExplosion(item.x, item.y);
                    bossHpFill.style.width = (boss.hp / boss.maxHp * 100) + '%';
                    items.splice(i, 1);
                    if (boss.hp <= 0) { score += 25000; boss.active = false; bossUi.style.display = 'none'; scoreDisplay.innerText = `‡πÅ‡∏ï‡πâ‡∏°: ${score}`; }
                }
            }
            if (item.y > 650) items.splice(i, 1);
        }

        effects.forEach((eff, i) => {
            ctx.beginPath(); ctx.strokeStyle = `rgba(255, 87, 34, ${eff.opacity})`; ctx.lineWidth=3;
            ctx.arc(eff.x, eff.y, eff.r, 0, Math.PI*2); ctx.stroke();
            eff.r += 6; eff.opacity -= 0.04;
            if (eff.opacity <= 0) effects.splice(i, 1);
        });

        requestAnimationFrame(animate);
    }
</script>
</body>
</html>
